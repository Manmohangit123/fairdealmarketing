{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\somen\\\\OneDrive\\\\Desktop\\\\marketing\\\\client\\\\src\\\\pages\\\\Products.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { fetchProducts, buyProduct } from \"../services/api\"; // make sure buyProduct exists\nimport { Link } from \"react-router-dom\";\nimport Navbar from \"../components/Navbar\";\nimport { QRCodeCanvas } from \"qrcode.react\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function Products() {\n  _s();\n  const [products, setProducts] = useState([]);\n  const [buying, setBuying] = useState(false);\n  useEffect(() => {\n    loadProducts();\n  }, []);\n  async function loadProducts() {\n    try {\n      const res = await fetchProducts();\n      setProducts(res.data);\n    } catch (err) {\n      console.error(\"Failed to fetch products:\", err);\n    }\n  }\n  async function handleBuy(product) {\n    try {\n      setBuying(true);\n\n      // Replace with the customer's wallet address\n      let buyerAddress = prompt(\"Enter your Aptos wallet address:\");\n      if (!buyerAddress) return alert(\"Wallet address required\");\n\n      // Normalize addresses\n      buyerAddress = buyerAddress.trim().toLowerCase();\n      const manufacturerAddress = product.manufacturerAddress.trim().toLowerCase();\n      const payload = {\n        ownerAddress: manufacturerAddress,\n        productId: product._id,\n        price: product.price,\n        customerId: buyerAddress\n      };\n      const res = await buyProduct(payload);\n      alert(\"Purchase successful! Transaction hash: \" + res.data.txHash);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(err);\n      alert(\"Purchase failed: \" + (((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || err.message));\n    } finally {\n      setBuying(false);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Products\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"small-muted\",\n          children: \"Scan QR to open product page & buy\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"products-list\",\n          children: products.map(p => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"product-row\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"product-thumb\",\n              children: p.image ? /*#__PURE__*/_jsxDEV(\"img\", {\n                src: p.image,\n                alt: \"\",\n                style: {\n                  width: \"100%\",\n                  height: \"100%\",\n                  borderRadius: 8,\n                  objectFit: \"cover\"\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 66,\n                columnNumber: 21\n              }, this) : \"IMG\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 64,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"product-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"product-title\",\n                children: /*#__PURE__*/_jsxDEV(Link, {\n                  to: `/product/${p._id}`,\n                  children: p.name || p.title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 83,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 82,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"product-price\",\n                children: [\"\\u20B9\", p.price]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 85,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  marginTop: 8\n                },\n                children: /*#__PURE__*/_jsxDEV(\"small\", {\n                  className: \"small-muted\",\n                  children: [\"Manufacturer: \", p.manufacturerAddress || p.manufacturer]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 87,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 86,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                width: 150\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"qr-box\",\n                children: p.qrCode ? /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: p.qrCode,\n                  alt: \"qr\",\n                  width: 120\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 96,\n                  columnNumber: 23\n                }, this) : /*#__PURE__*/_jsxDEV(QRCodeCanvas, {\n                  value: `${window.location.origin}/product/${p._id}`,\n                  size: 120\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 98,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 94,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                disabled: buying,\n                style: {\n                  marginTop: 8,\n                  padding: \"6px 12px\",\n                  borderRadius: 6,\n                  background: \"#4caf50\",\n                  color: \"#fff\",\n                  cursor: \"pointer\",\n                  border: \"none\"\n                },\n                onClick: () => handleBuy(p),\n                children: buying ? \"Buying...\" : \"Buy\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 105,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 93,\n              columnNumber: 17\n            }, this)]\n          }, p._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 63,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n_s(Products, \"5kUUfgocLEVELEj9X4SvWi7TAj0=\");\n_c = Products;\nvar _c;\n$RefreshReg$(_c, \"Products\");","map":{"version":3,"names":["React","useEffect","useState","fetchProducts","buyProduct","Link","Navbar","QRCodeCanvas","jsxDEV","_jsxDEV","Fragment","_Fragment","Products","_s","products","setProducts","buying","setBuying","loadProducts","res","data","err","console","error","handleBuy","product","buyerAddress","prompt","alert","trim","toLowerCase","manufacturerAddress","payload","ownerAddress","productId","_id","price","customerId","txHash","_err$response","_err$response$data","response","message","children","fileName","_jsxFileName","lineNumber","columnNumber","className","map","p","image","src","alt","style","width","height","borderRadius","objectFit","to","name","title","marginTop","manufacturer","qrCode","value","window","location","origin","size","disabled","padding","background","color","cursor","border","onClick","_c","$RefreshReg$"],"sources":["C:/Users/somen/OneDrive/Desktop/marketing/client/src/pages/Products.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { fetchProducts, buyProduct } from \"../services/api\"; // make sure buyProduct exists\r\nimport { Link } from \"react-router-dom\";\r\nimport Navbar from \"../components/Navbar\";\r\nimport { QRCodeCanvas } from \"qrcode.react\";\r\n\r\nexport default function Products() {\r\n  const [products, setProducts] = useState([]);\r\n  const [buying, setBuying] = useState(false);\r\n\r\n  useEffect(() => {\r\n    loadProducts();\r\n  }, []);\r\n\r\n  async function loadProducts() {\r\n    try {\r\n      const res = await fetchProducts();\r\n      setProducts(res.data);\r\n    } catch (err) {\r\n      console.error(\"Failed to fetch products:\", err);\r\n    }\r\n  }\r\n\r\n  async function handleBuy(product) {\r\n    try {\r\n      setBuying(true);\r\n\r\n      // Replace with the customer's wallet address\r\n      let buyerAddress = prompt(\"Enter your Aptos wallet address:\");\r\n      if (!buyerAddress) return alert(\"Wallet address required\");\r\n\r\n      // Normalize addresses\r\n      buyerAddress = buyerAddress.trim().toLowerCase();\r\n      const manufacturerAddress = product.manufacturerAddress.trim().toLowerCase();\r\n\r\n      const payload = {\r\n        ownerAddress: manufacturerAddress,\r\n        productId: product._id,\r\n        price: product.price,\r\n        customerId: buyerAddress\r\n      };\r\n\r\n      const res = await buyProduct(payload);\r\n      alert(\"Purchase successful! Transaction hash: \" + res.data.txHash);\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert(\"Purchase failed: \" + (err.response?.data?.error || err.message));\r\n    } finally {\r\n      setBuying(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Navbar />\r\n      <div className=\"container\">\r\n        <div className=\"card\">\r\n          <h1>Products</h1>\r\n          <p className=\"small-muted\">Scan QR to open product page & buy</p>\r\n\r\n          <div className=\"products-list\">\r\n            {products.map(p => (\r\n              <div key={p._id} className=\"product-row\">\r\n                <div className=\"product-thumb\">\r\n                  {p.image ? (\r\n                    <img\r\n                      src={p.image}\r\n                      alt=\"\"\r\n                      style={{\r\n                        width: \"100%\",\r\n                        height: \"100%\",\r\n                        borderRadius: 8,\r\n                        objectFit: \"cover\"\r\n                      }}\r\n                    />\r\n                  ) : (\r\n                    \"IMG\"\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"product-info\">\r\n                  <div className=\"product-title\">\r\n                    <Link to={`/product/${p._id}`}>{p.name || p.title}</Link>\r\n                  </div>\r\n                  <div className=\"product-price\">â‚¹{p.price}</div>\r\n                  <div style={{ marginTop: 8 }}>\r\n                    <small className=\"small-muted\">\r\n                      Manufacturer: {p.manufacturerAddress || p.manufacturer}\r\n                    </small>\r\n                  </div>\r\n                </div>\r\n\r\n                <div style={{ width: 150 }}>\r\n                  <div className=\"qr-box\">\r\n                    {p.qrCode ? (\r\n                      <img src={p.qrCode} alt=\"qr\" width={120} />\r\n                    ) : (\r\n                      <QRCodeCanvas\r\n                        value={`${window.location.origin}/product/${p._id}`}\r\n                        size={120}\r\n                      />\r\n                    )}\r\n                  </div>\r\n\r\n                  <button\r\n                    disabled={buying}\r\n                    style={{\r\n                      marginTop: 8,\r\n                      padding: \"6px 12px\",\r\n                      borderRadius: 6,\r\n                      background: \"#4caf50\",\r\n                      color: \"#fff\",\r\n                      cursor: \"pointer\",\r\n                      border: \"none\"\r\n                    }}\r\n                    onClick={() => handleBuy(p)}\r\n                  >\r\n                    {buying ? \"Buying...\" : \"Buy\"}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,SAASC,aAAa,EAAEC,UAAU,QAAQ,iBAAiB,CAAC,CAAC;AAC7D,SAASC,IAAI,QAAQ,kBAAkB;AACvC,OAAOC,MAAM,MAAM,sBAAsB;AACzC,SAASC,YAAY,QAAQ,cAAc;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAE5C,eAAe,SAASC,QAAQA,CAAA,EAAG;EAAAC,EAAA;EACjC,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACc,MAAM,EAAEC,SAAS,CAAC,GAAGf,QAAQ,CAAC,KAAK,CAAC;EAE3CD,SAAS,CAAC,MAAM;IACdiB,YAAY,CAAC,CAAC;EAChB,CAAC,EAAE,EAAE,CAAC;EAEN,eAAeA,YAAYA,CAAA,EAAG;IAC5B,IAAI;MACF,MAAMC,GAAG,GAAG,MAAMhB,aAAa,CAAC,CAAC;MACjCY,WAAW,CAACI,GAAG,CAACC,IAAI,CAAC;IACvB,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEF,GAAG,CAAC;IACjD;EACF;EAEA,eAAeG,SAASA,CAACC,OAAO,EAAE;IAChC,IAAI;MACFR,SAAS,CAAC,IAAI,CAAC;;MAEf;MACA,IAAIS,YAAY,GAAGC,MAAM,CAAC,kCAAkC,CAAC;MAC7D,IAAI,CAACD,YAAY,EAAE,OAAOE,KAAK,CAAC,yBAAyB,CAAC;;MAE1D;MACAF,YAAY,GAAGA,YAAY,CAACG,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;MAChD,MAAMC,mBAAmB,GAAGN,OAAO,CAACM,mBAAmB,CAACF,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;MAE5E,MAAME,OAAO,GAAG;QACdC,YAAY,EAAEF,mBAAmB;QACjCG,SAAS,EAAET,OAAO,CAACU,GAAG;QACtBC,KAAK,EAAEX,OAAO,CAACW,KAAK;QACpBC,UAAU,EAAEX;MACd,CAAC;MAED,MAAMP,GAAG,GAAG,MAAMf,UAAU,CAAC4B,OAAO,CAAC;MACrCJ,KAAK,CAAC,yCAAyC,GAAGT,GAAG,CAACC,IAAI,CAACkB,MAAM,CAAC;IACpE,CAAC,CAAC,OAAOjB,GAAG,EAAE;MAAA,IAAAkB,aAAA,EAAAC,kBAAA;MACZlB,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC;MAClBO,KAAK,CAAC,mBAAmB,IAAI,EAAAW,aAAA,GAAAlB,GAAG,CAACoB,QAAQ,cAAAF,aAAA,wBAAAC,kBAAA,GAAZD,aAAA,CAAcnB,IAAI,cAAAoB,kBAAA,uBAAlBA,kBAAA,CAAoBjB,KAAK,KAAIF,GAAG,CAACqB,OAAO,CAAC,CAAC;IACzE,CAAC,SAAS;MACRzB,SAAS,CAAC,KAAK,CAAC;IAClB;EACF;EAEA,oBACER,OAAA,CAAAE,SAAA;IAAAgC,QAAA,gBACElC,OAAA,CAACH,MAAM;MAAAsC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,eACVtC,OAAA;MAAKuC,SAAS,EAAC,WAAW;MAAAL,QAAA,eACxBlC,OAAA;QAAKuC,SAAS,EAAC,MAAM;QAAAL,QAAA,gBACnBlC,OAAA;UAAAkC,QAAA,EAAI;QAAQ;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACjBtC,OAAA;UAAGuC,SAAS,EAAC,aAAa;UAAAL,QAAA,EAAC;QAAkC;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC,eAEjEtC,OAAA;UAAKuC,SAAS,EAAC,eAAe;UAAAL,QAAA,EAC3B7B,QAAQ,CAACmC,GAAG,CAACC,CAAC,iBACbzC,OAAA;YAAiBuC,SAAS,EAAC,aAAa;YAAAL,QAAA,gBACtClC,OAAA;cAAKuC,SAAS,EAAC,eAAe;cAAAL,QAAA,EAC3BO,CAAC,CAACC,KAAK,gBACN1C,OAAA;gBACE2C,GAAG,EAAEF,CAAC,CAACC,KAAM;gBACbE,GAAG,EAAC,EAAE;gBACNC,KAAK,EAAE;kBACLC,KAAK,EAAE,MAAM;kBACbC,MAAM,EAAE,MAAM;kBACdC,YAAY,EAAE,CAAC;kBACfC,SAAS,EAAE;gBACb;cAAE;gBAAAd,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACH,CAAC,GAEF;YACD;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC,eAENtC,OAAA;cAAKuC,SAAS,EAAC,cAAc;cAAAL,QAAA,gBAC3BlC,OAAA;gBAAKuC,SAAS,EAAC,eAAe;gBAAAL,QAAA,eAC5BlC,OAAA,CAACJ,IAAI;kBAACsD,EAAE,EAAE,YAAYT,CAAC,CAACf,GAAG,EAAG;kBAAAQ,QAAA,EAAEO,CAAC,CAACU,IAAI,IAAIV,CAAC,CAACW;gBAAK;kBAAAjB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAO;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACtD,CAAC,eACNtC,OAAA;gBAAKuC,SAAS,EAAC,eAAe;gBAAAL,QAAA,GAAC,QAAC,EAACO,CAAC,CAACd,KAAK;cAAA;gBAAAQ,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,eAC/CtC,OAAA;gBAAK6C,KAAK,EAAE;kBAAEQ,SAAS,EAAE;gBAAE,CAAE;gBAAAnB,QAAA,eAC3BlC,OAAA;kBAAOuC,SAAS,EAAC,aAAa;kBAAAL,QAAA,GAAC,gBACf,EAACO,CAAC,CAACnB,mBAAmB,IAAImB,CAAC,CAACa,YAAY;gBAAA;kBAAAnB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACjD;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACL,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CAAC,eAENtC,OAAA;cAAK6C,KAAK,EAAE;gBAAEC,KAAK,EAAE;cAAI,CAAE;cAAAZ,QAAA,gBACzBlC,OAAA;gBAAKuC,SAAS,EAAC,QAAQ;gBAAAL,QAAA,EACpBO,CAAC,CAACc,MAAM,gBACPvD,OAAA;kBAAK2C,GAAG,EAAEF,CAAC,CAACc,MAAO;kBAACX,GAAG,EAAC,IAAI;kBAACE,KAAK,EAAE;gBAAI;kBAAAX,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAE,CAAC,gBAE3CtC,OAAA,CAACF,YAAY;kBACX0D,KAAK,EAAE,GAAGC,MAAM,CAACC,QAAQ,CAACC,MAAM,YAAYlB,CAAC,CAACf,GAAG,EAAG;kBACpDkC,IAAI,EAAE;gBAAI;kBAAAzB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACX;cACF;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACE,CAAC,eAENtC,OAAA;gBACE6D,QAAQ,EAAEtD,MAAO;gBACjBsC,KAAK,EAAE;kBACLQ,SAAS,EAAE,CAAC;kBACZS,OAAO,EAAE,UAAU;kBACnBd,YAAY,EAAE,CAAC;kBACfe,UAAU,EAAE,SAAS;kBACrBC,KAAK,EAAE,MAAM;kBACbC,MAAM,EAAE,SAAS;kBACjBC,MAAM,EAAE;gBACV,CAAE;gBACFC,OAAO,EAAEA,CAAA,KAAMpD,SAAS,CAAC0B,CAAC,CAAE;gBAAAP,QAAA,EAE3B3B,MAAM,GAAG,WAAW,GAAG;cAAK;gBAAA4B,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACvB,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACN,CAAC;UAAA,GAzDEG,CAAC,CAACf,GAAG;YAAAS,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OA0DV,CACN;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACC,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAAA,eACN,CAAC;AAEP;AAAClC,EAAA,CAzHuBD,QAAQ;AAAAiE,EAAA,GAARjE,QAAQ;AAAA,IAAAiE,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}